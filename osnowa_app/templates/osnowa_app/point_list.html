{% extends 'osnowa_app/base.html' %}

{#Mój główny widok strony - mapa#}

{% block content %}

<div class="map">
<!--*************************Szerokość i wysokość okna z mapą****************************************************************************-->
		<div id="mapid" style="width: 1900px; height: 900px"></div>
		
		<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
		
		<!--Plik JavaScript*********************************************Do osobnego pliku jak się da***************************************-->
		<script>
		/* -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
			/*Startowy widok mapy ([jakieś współrzędne], powiększenie)*/
			var mymap = L.map('mapid').setView([50.06585, 19.92022], 17);

			L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
				maxZoom: 22,
				attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
					'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
					'Imagery © <a href="http://mapbox.com">Mapbox</a>',
				id: 'mapbox.streets'
			}).addTo(mymap);


			/*Położenie znacznka na mapie ([Jakieś współrzędne]), Podpis znacznika*/
			L.marker([50.06585, 19.92022]).addTo(mymap)
				.bindPopup("<b>Budynek C4</b><br />Tutaj znajduje się Wydział Geodezji Górniczej i Inżynierii Środowiska.").openPopup();




            function highlightFeature(e) {
                var layer = e.target;

                layer.setStyle({
                    weight: 5,
                    color: '#666',
                    dashArray: '',
                    fillOpacity: 0.7
                });

                if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                    layer.bringToFront();
                }
            }



            function resetHighlight(e) {
                geojson.resetStyle(e.target);
            }





/*Tworzenie poligonu*/
			L.polygon([
				[50.0675, 19.90322],
				[50.06995, 19.90407],
				[50.06896, 19.91109],
				[50.06757, 19.91474],
				[50.06757, 19.91802],
				[50.06577, 19.92401],
				[50.06401, 19.92351],
				[50.06469, 19.91906]
			/*Podpis poligonu*/
			]).addTo(mymap).bindPopup("Teren AGH.");

			/*Tworzenie kółka*/
			L.circle([50.06585, 19.92022], 25, {
				color: 'red',
				fillColor: '#f03',
				/*Przezroczystość*/
				fillOpacity: 0.5
			/*Podpis kółka*/
			}).addTo(mymap).bindPopup("Zagrożenie! Duże natężenie geodetów!!!");

/*Tworzenie znacznika*/
			var popup = L.popup();

			function onMapClick(e) {
				popup
					.setLatLng(e.latlng)
					.setContent("Tutaj znajdują się współrzędne: " + e.latlng.toString())
					.openOn(mymap);
			}
            mymap.on('click', onMapClick);




            /*Podanie wspólnych cech wszystkich obrazków*/
			var ZnacznikIcon = L.Icon.extend({
				options: {
					/*shadowUrl: '../docs/images/leaf-shadow.png',*/
					iconSize:     [23.65, 36],		//Rozmiar znacznika
{#					/*shadowSize:   [50, 64],*/#}
					iconAnchor:   [11.825, 36],		//Punkt zaczepienia znacznika
					/*shadowAnchor: [4, 62],*/
					popupAnchor:  [0, -28] //Punkt zaczepienia dymku
				}
			});

			var blueIcon = new ZnacznikIcon({iconUrl: "/static/images/znacznik-blue.png"}),
				greenIcon = new ZnacznikIcon({iconUrl: '/static/images/znacznik-green.png'}),
				yellowIcon = new ZnacznikIcon({iconUrl: '/static/images/znacznik_yellow.png'}),
				redIcon = new ZnacznikIcon({iconUrl: '/static/images/znacznik_red.png'});


{#        Stara wersja:  #}

{#            var tablica = [#}
{#                    W points jest lista obiektów klasy Point przesłana z widoku#}
{#            {% for point in points %}#}
{#                [{{ point.nazwa }}],#}
{#            {% endfor %}];#}
{#            console.log(tablica);#}
{##}
{#            var number = [#}
{#            {% for point in points %}#}
{#                "{{ point.numer }}",#}
{#            {% endfor %}];#}
{#            Wypisanie w konsoli mojej tablicy number#}
{#            console.log(number);#}



            {% for point in points %}
                L.marker([{{ point.wsp_WGS84 }}], {icon: greenIcon})
                        .bindPopup("<b>Numer: </b>{{ point.numer }}<br />" + "<b>Wsp.: {{ point.wsp_2000 }}</b>" + "<br />" + "<a href = \"{% url 'point_detail' pk=point.pk %}\">Zobacz opis punktu</a>").addTo(mymap);
            {% endfor %}

		</script>


		<script>
			
		/* -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
		/*Wstawianie obrazka.png jako znacznik*/	
			
			L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
			attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
		    }).addTo(mymap);

{#                addTo dodaje znacznik do mapy mymap#}


		</script>
</div>
{% endblock content %}

